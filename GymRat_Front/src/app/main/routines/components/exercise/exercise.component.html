<form
  [formGroup]="this.exerciseForm"
  class="m-auto p-4 w-3/5 flex flex-col items-center"
>
  <h1 class="p-4 text-center text-lg" *ngIf="this.exerciseNumber > 0">
    Exercise {{ this.exerciseNumber }}
  </h1>
  <div class="grid md:grid-cols-2 sm:grid-cols-1">
    <div class="relative">
      <div class="flex items-end" #searchRef>
        <shared-input
          class="p-2 relative"
          inputType="text"
          inputPlaceholder="Name"
          ngDefaultControl
          formControlName="exerciseName"
          label="Exercise Name"
          [inputValue]="this.exerciseForm.get('exerciseName')?.value"
          (keyUp)="this.onKeyPress($event)"
        />
        <img
          class="w-10 h-10 hover:cursor-pointer"
          src="assets/search-icon.png"
          alt="search"
          (click)="this.isExerciseSearchOpen = !this.isExerciseSearchOpen"
        />
      </div>

      <shared-dropdown
        dropdownClassNames="w-full h-44 left-0"
        [openComponentRef]="this.searchDivRef"
        [isOpen]="this.isExerciseSearchOpen"
        (onClickOutise)="this.onCloseDropdown()"
      >
        <li
          class="w-full p-2 flex justify-between hover:bg-gray-200 cursor-pointer"
          *ngFor="let filteredExercises of this.filteredExercises"
          (click)="this.onFilteredExerciseClick(filteredExercises)"
        >
          <p>{{ filteredExercises.name }}</p>
        </li>
      </shared-dropdown>
    </div>

    <shared-input
      class="p-2"
      inputType="number"
      inputPlaceholder="Series"
      label="Series"
      ngDefaultControl
      formControlName="series"
      [inputValue]="this.exerciseForm.get('series')?.value"
    />
    <shared-input
      class="p-2"
      inputType="select"
      inputPlaceholder="Muscle"
      label="Muscle"
      [selectorTypes]="this.muscles"
      ngDefaultControl
      formControlName="muscle"
      [inputValue]="this.exerciseForm.get('muscle')?.value"
    />
    <shared-input
      class="p-2"
      inputType="select"
      inputPlaceholder="Type"
      label="Type"
      [selectorTypes]="this.types"
      ngDefaultControl
      formControlName="type"
      [inputValue]="this.exerciseForm.get('type')?.value"
    />
    <shared-input
      class="p-2"
      inputType="select"
      inputPlaceholder="Difficulty"
      label="Difficulty"
      [selectorTypes]="this.difficulties"
      ngDefaultControl
      formControlName="difficulty"
      [inputValue]="this.exerciseForm.get('difficulty')?.value"
    />
  </div>

  <div *ngIf="this.series.length > 0">
    <div class="flex flex-col">
      <p class="text-center font-bold">Repetitions</p>
      <div
        [class]="
          this.series.length < 5
            ? 'flex'
            : 'grid lg:grid-cols-3 md:grid-cols-2 sm:grid-cols-1'
        "
        formGroupName="reps"
      >
        <shared-input
          *ngFor="let item of this.series"
          class="p-2 w-full"
          inputType="number"
          inputPlaceholder="Rep {{ item + 1 }}"
          label="Rep {{ item + 1 }}"
          ngDefaultControl
          formControlName="r{{ item }}"
          [inputValue]="this.exercise?.reps ? (this.exercise?.reps)![item] : ''"
        />
      </div>
    </div>
    <div class="flex flex-col">
      <p class="text-center font-bold">Weights</p>
      <div
        [class]="
          this.series.length < 5
            ? 'flex'
            : 'grid lg:grid-cols-3 md:grid-cols-2 sm:grid-cols-1'
        "
        formGroupName="weights"
      >
        <shared-input
          *ngFor="let item of this.series"
          class="p-2"
          inputType="number"
          inputStep="0.1"
          inputPlaceholder="Weight {{ item + 1 }} (kg)"
          label="Weight {{ item + 1 }} (kg)"
          ngDefaultControl
          formControlName="w{{ item }}"
          [inputValue]="
            this.exercise?.weights ? (this.exercise?.weights)![item] : ''
          "
        />
      </div>
    </div>
  </div>
</form>
